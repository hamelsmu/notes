"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[1005],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>b});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=c(r),m=a,b=u["".concat(l,".").concat(m)]||u[m]||d[m]||o;return r?n.createElement(b,s(s({ref:t},p),{},{components:r})):n.createElement(b,s({ref:t},p))}));function b(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,s=new Array(o);s[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[u]="string"==typeof e?e:a,s[1]=i;for(var c=2;c<o;c++)s[c]=r[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},5364:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var n=r(7462),a=(r(7294),r(3905));const o={},s=void 0,i={unversionedId:"k8s/Ambassador Sidecars",id:"k8s/Ambassador Sidecars",title:"Ambassador Sidecars",description:"[[Ambassador]]",source:"@site/docs/k8s/09-Ambassador Sidecars.md",sourceDirName:"k8s",slug:"/k8s/Ambassador Sidecars",permalink:"/k8s/Ambassador Sidecars",draft:!1,editUrl:"https://github.dev/hamelsmu/notes/blob/master/docs/k8s/09-Ambassador Sidecars.md",tags:[],version:"current",sidebarPosition:9,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Multi Container Pods",permalink:"/k8s/Multi Container Pods"},next:{title:"Downsides of MC Pods",permalink:"/k8s/Downsides of MC Pods"}},l={},c=[],p={toc:c};function u(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"[","[Ambassador]","]"),(0,a.kt)("p",null,"These are [","[Sidecar]","] containers that act as proxys.  You can do this for reliability or security.  Proxy containers can do load balancing, retries, or encrypt items.  [","[service mesh]","] uses patterns like this. "),(0,a.kt)("p",null,"For example you may want to restrict what web requests or URLs your app is allowed to talk to.  With an ambassador sidecar, you can block all traffic besides the allowed one.   Here is an example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'      containers:\n        - name: web\n          image: kiamol/ch03-numbers-web \n          env:\n          - name: http_proxy\n            value: http://localhost:1080\n          - name: RngApi__Url\n            value: http://localhost/api\n        - name: proxy                         # this is a basic proxy\n          image: kiamol/ch07-simple-proxy          \n          env:\n          - name: Proxy__Port                 #Routes network requets given \n            value: "1080"                     # the below mapping\n          - name: Proxy__Request__UriMap__Source\n            value: http://localhost/api\n          - name: Proxy__Request__UriMap__Target\n            value: http://numbers-api/sixeyed/kiamol/master/ch03/numbers/rng\n\n')),(0,a.kt)("p",null,"In the above example, anything that is not in the mapping  is blocked.   Now the web app is restricted to a single address for outgoing requests, which are logged by the proxy. "),(0,a.kt)("p",null,"the app container uses localhost addresses for any services it consumes, and it\u2019s configured to route all network calls through the proxy container. The proxy is a custom app that logs network calls, maps localhost addresses to real addresses, and blocks any addresses that are not listed in the map. All that becomes functionality in the Pod, but it\u2019s transparent to the application container."),(0,a.kt)("p",null,"You can also use Ambassador's for database connections, to query read-only copies when there are no db updates/writes:"),(0,a.kt)("p",null,(0,a.kt)("img",{src:r(2405).Z,width:"571",height:"582"})))}u.isMDXComponent=!0},2405:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/20221210204112-f764a8e7ca43c083e99912fbf50c4648.png"}}]);